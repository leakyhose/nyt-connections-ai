<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connections - by Yiming Su</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            background: #050212;
            background-image: 
                radial-gradient(circle at 11% 7%, rgba(255,255,255,0.95) 0.3px, transparent 0.7px),
                radial-gradient(circle at 83% 71%, rgba(255,255,255,0.7) 0.9px, transparent 1.3px),
                radial-gradient(circle at 37% 94%, rgba(255,255,255,0.85) 0.5px, transparent 0.9px),
                radial-gradient(circle at 67% 19%, rgba(255,255,255,0.6) 1.1px, transparent 1.6px),
                radial-gradient(circle at 23% 58%, rgba(255,255,255,0.8) 0.4px, transparent 0.8px),
                radial-gradient(circle at 89% 33%, rgba(255,255,255,0.9) 0.7px, transparent 1.1px),
                radial-gradient(circle at 3% 82%, rgba(255,255,255,0.5) 0.6px, transparent 1px),
                radial-gradient(circle at 51% 26%, rgba(255,255,255,0.75) 0.8px, transparent 1.2px);
            background-size: 340px 290px, 480px 370px, 290px 520px, 410px 330px, 380px 450px, 320px 280px, 460px 390px, 350px 430px;
            color: #e0e0e0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 20px;
            margin: 0;
        }

        .container {
            max-width: 1020px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            transform: scale(1.26);
            transform-origin: top center;
        }

        h1 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 2.3em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            color: #e6d7ff;
            position: relative;
            display: inline-block;
        }

        .title-container {
            text-align: center;
            margin-bottom: 25px;
            margin-top: 15px;
            position: relative;
        }

        .info-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(138, 124, 168, 0.9);
            border: 1px solid rgba(160, 143, 184, 0.6);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            color: #ffffff;
            font-size: 24px;
            font-weight: normal;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(60, 40, 100, 0.1);
            font-family: Georgia, serif;
            z-index: 1000;
            pointer-events: auto;
        }

        .info-button:hover {
            background: rgba(160, 143, 184, 0.95);
            transform: scale(1.1);
            box-shadow: 0 2px 5px rgba(80, 60, 120, 0.15);
        }

        .info-button:active {
            transform: scale(0.95);
        }

        .info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .info-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .info-modal-content {
            background: linear-gradient(135deg, #1a1428, #2a1e38);
            border: 2px solid #8a7ca8;
            border-radius: 15px;
            max-width: 750px;
            max-height: 85vh;
            width: 95%;
            padding: 40px;
            position: relative;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .info-modal-content::-webkit-scrollbar {
            width: 8px;
        }

        .info-modal-content::-webkit-scrollbar-track {
            background: rgba(40, 30, 50, 0.5);
            border-radius: 4px;
        }

        .info-modal-content::-webkit-scrollbar-thumb {
            background: #8a7ca8;
            border-radius: 4px;
        }

        .info-modal-content::-webkit-scrollbar-thumb:hover {
            background: #a08fb8;
        }

        .close-button {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            color: #e0e0e0;
            cursor: pointer;
            padding: 5px;
            line-height: 1;
        }

        .close-button:hover {
            color: #ff9fda;
        }

        .info-modal h2 {
            color: #f0e6ff;
            font-size: 2.2em;
            margin-bottom: 25px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            font-weight: normal;
        }

        .info-modal h3 {
            color: #d4c4f0;
            font-size: 1.6em;
            margin: 30px 0 15px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            font-weight: normal;
        }

        .info-modal p {
            color: #e8e8e8;
            line-height: 1.8;
            margin-bottom: 20px;
            text-align: left;
            font-size: 1.1em;
            font-weight: normal;
        }

        .info-modal a {
            color: #c9b3ff;
            text-decoration: none;
            transition: color 0.3s ease;
            font-weight: normal;
        }

        .info-modal a:hover {
            color: #e6d7ff;
            text-decoration: underline;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0 auto 25px auto;
            background: linear-gradient(135deg, rgba(35, 15, 50, 0.9), rgba(25, 15, 40, 0.9));
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(80, 50, 120, 0.4);
            box-shadow: 0 2px 8px rgba(50, 20, 80, 0.3);
            width: 100%;
            max-width: 875px;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .game-info.intro-mode {
            max-width: 500px;
            padding: 30px;
            transform: scale(1.2);
            margin: 50px auto;
            justify-content: center;
        }

        .game-info.intro-mode .game-controls {
            justify-content: center;
        }

        .game-info.intro-mode .stats-display {
            display: none;
        }

        .game-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        input, button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
        }

        input {
            background: rgba(40, 30, 70, 0.9);
            color: #f0f0f0;
            width: 100px;
            border: 1px solid rgba(120, 90, 160, 0.6);
        }

        button {
            background: linear-gradient(135deg, rgba(90, 60, 130, 0.9), rgba(70, 45, 110, 0.9));
            color: #f0f0f0;
            cursor: pointer;
            transition: all 0.15s ease;
            border: 1px solid rgba(120, 90, 160, 0.7);
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        button:hover {
            background: linear-gradient(135deg, rgba(110, 80, 150, 0.95), rgba(90, 65, 130, 0.95));
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(90, 60, 130, 0.4);
        }

        button:disabled {
            background: #1a1a1a;
            cursor: not-allowed;
            transform: none;
            color: #666;
            box-shadow: none;
        }

        .main-content {
            display: flex;
            gap: 25px;
            align-items: flex-start;
            justify-content: center;
            width: 100%;
            max-width: 875px;
            opacity: 1;
            transform: translateY(0);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .main-content.hidden {
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
        }

        .game-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 500px;
        }

        .word-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 480px;
            justify-self: center;
        }

        .word-card {
            background: linear-gradient(135deg, rgba(30, 15, 45, 0.9), rgba(20, 10, 35, 0.9));
            border: 2px solid rgba(80, 50, 120, 0.6);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
            font-size: 0.95em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.15s ease;
            backdrop-filter: blur(8px);
            min-height: 65px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #e0e0e0;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        .word-card:hover {
            background: linear-gradient(135deg, rgba(40, 25, 55, 0.95), rgba(30, 20, 45, 0.95));
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(50, 30, 80, 0.3);
            border-color: rgba(100, 70, 140, 0.8);
        }

        .word-card.selected {
            background: linear-gradient(135deg, rgba(180, 60, 120, 0.9), rgba(160, 40, 100, 0.9));
            border-color: #e91e63;
            color: #fff;
            box-shadow: 0 2px 6px rgba(180, 60, 120, 0.4);
        }

        .word-card.found {
            background: linear-gradient(135deg, rgba(20, 60, 35, 0.9), rgba(15, 50, 25, 0.9));
            border-color: #4caf50;
            cursor: default;
            color: #fff;
        }

        .word-card.found:hover {
            transform: none;
        }

        .suggestions-panel {
            background: linear-gradient(135deg, rgba(25, 10, 40, 0.95), rgba(15, 10, 30, 0.95));
            border-radius: 10px;
            padding: 18px;
            backdrop-filter: blur(15px);
            width: 350px;
            max-height: 410px;
            overflow-y: auto;
            border: 1px solid rgba(70, 40, 110, 0.5);
            box-shadow: 0 4px 12px rgba(40, 20, 70, 0.3);
        }

        /* Custom Scrollbar Styling */
        .suggestions-panel::-webkit-scrollbar {
            width: 8px;
        }

        .suggestions-panel::-webkit-scrollbar-track {
            background: rgba(20, 10, 35, 0.3);
            border-radius: 4px;
        }

        .suggestions-panel::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, rgba(80, 50, 120, 0.8), rgba(60, 40, 100, 0.8));
            border-radius: 4px;
            border: 1px solid rgba(100, 70, 140, 0.4);
        }

        .suggestions-panel::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, rgba(100, 70, 140, 0.9), rgba(80, 60, 120, 0.9));
        }

        /* Firefox scrollbar */
        .suggestions-panel {
            scrollbar-width: thin;
            scrollbar-color: rgba(80, 50, 120, 0.8) rgba(20, 10, 35, 0.3);
        }

        .suggestions-title {
            font-size: 1.1em;
            margin-bottom: 15px;
            text-align: center;
            color: #d0c0e0;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        .suggestion-item {
            background: linear-gradient(135deg, rgba(30, 15, 45, 0.9), rgba(20, 10, 35, 0.9));
            border: 1px solid rgba(80, 50, 120, 0.6);
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.12s ease;
            position: relative;
            overflow: hidden;
        }

        .suggestion-item:hover {
            background: linear-gradient(135deg, rgba(40, 25, 55, 0.95), rgba(30, 20, 45, 0.95));
            transform: translateX(2px);
            box-shadow: 0 2px 6px rgba(50, 30, 80, 0.3);
            border-color: rgba(100, 70, 140, 0.8);
        }

        .suggestion-item.removing {
            animation: slideOutRight 0.15s ease-in-out forwards;
            pointer-events: none;
        }

        @keyframes slideOutRight {
            0% {
                transform: translateX(0);
                opacity: 1;
                max-height: 60px;
                margin-bottom: 6px;
                padding: 8px;
            }
            50% {
                transform: translateX(15px);
                opacity: 0.3;
            }
            100% {
                transform: translateX(50px);
                opacity: 0;
                max-height: 0;
                margin-bottom: 0;
                padding: 0;
            }
        }

        .suggestion-rank {
            font-weight: bold;
            color: #d0c0e0;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            font-size: 0.85em;
        }

        .suggestion-words {
            margin: 3px 0;
            color: #e0e0e0;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            font-size: 0.8em;
        }

        .suggestion-score {
            font-size: 0.7em;
            color: #b0a0c0;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        .result-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            padding: 17px 30px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            z-index: 10000;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            animation: resultPopup 1.25s ease-in-out forwards;
            pointer-events: auto;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            backdrop-filter: blur(2px);
        }

        .popup-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        @keyframes resultPopup {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.7);
            }
            15% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.02);
            }
            25% {
                transform: translate(-50%, -50%) scale(1);
            }
            85% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.95);
            }
        }

        .result-correct {
            background: linear-gradient(135deg, rgba(20, 80, 35, 0.95), rgba(15, 70, 25, 0.95));
            border: 2px solid #4caf50;
            color: #fff;
        }

        .result-one-away {
            background: linear-gradient(135deg, rgba(120, 90, 20, 0.95), rgba(100, 70, 15, 0.95));
            border: 2px solid #d4af37;
            color: #fff;
        }

        .result-incorrect {
            background: linear-gradient(135deg, rgba(120, 20, 35, 0.95), rgba(100, 15, 25, 0.95));
            border: 2px solid #f44336;
            color: #fff;
        }

        .result-completion {
            background: linear-gradient(135deg, rgba(50, 30, 90, 0.95), rgba(35, 20, 75, 0.95));
            border: 2px solid #9c6adc;
            color: #fff;
            font-size: 1.05em;
            animation: completionPopup 1.25s ease-in-out forwards;
        }

        @keyframes completionPopup {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.7);
            }
            15% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.02);
            }
            25% {
                transform: translate(-50%, -50%) scale(1);
            }
            90% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.95);
            }
        }

        .loading {
            text-align: center;
            font-size: 0.9em;
            margin: 30px 0;
            color: #b0a0c0;
        }

        .game-stats {
            background: linear-gradient(135deg, rgba(25, 10, 40, 0.9), rgba(15, 10, 30, 0.9));
            padding: 12px;
            border-radius: 8px;
            margin-top: 18px;
            text-align: center;
            border: 1px solid rgba(70, 40, 110, 0.5);
            box-shadow: 0 2px 8px rgba(40, 20, 70, 0.3);
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .game-stats.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .groups-found {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 18px;
        }

        .group-indicator {
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(30, 15, 45, 0.9), rgba(20, 10, 35, 0.9));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border: 2px solid rgba(80, 50, 120, 0.6);
            color: #b0b0b0;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            transition: all 0.15s ease;
            font-size: 0.8em;
        }

        .group-indicator.found {
            background: linear-gradient(135deg, rgba(20, 60, 35, 0.9), rgba(15, 50, 25, 0.9));
            border-color: #4caf50;
            color: #fff;
            box-shadow: 0 2px 6px rgba(20, 60, 35, 0.4);
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
                gap: 13px;
            }
            
            .suggestions-panel {
                width: 100%;
                max-width: 510px;
            }
            
            .game-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .word-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            body {
                transform: scale(0.9);
            }
        }
    </style>
</head>
<body>
    <div class="popup-overlay" id="popupOverlay"></div>
    
    <!-- Info Button - Fixed at bottom left -->
    <button class="info-button" id="infoBtn" title="About ConnectionsAI">i</button>
    
    <div class="container" id="mainContainer">
        <div class="title-container">
            <h1>ConnectionsAI - by Yiming Su</h1>
        </div>
        
        <div class="game-info intro-mode" id="gameInfo">
            <div class="game-controls">
                <label for="gameNumber">Game #:</label>
                <input type="number" id="gameNumber" min="0" max="379" value="1">
                <button onclick="loadRandomGame()">Load Random Game</button>
            </div>
            <div class="stats-display">
                <span id="turnsCounter">Turns: 0</span> | 
                <span id="groupsCounter">Groups: 0/4</span>
            </div>
        </div>

        <div class="main-content hidden" id="mainContent">
            <div class="game-area">
                <div class="word-grid" id="wordGrid">
                    <!-- Words will be populated here -->
                </div>
                
                <div class="groups-found">
                    <div class="group-indicator" id="group1">1</div>
                    <div class="group-indicator" id="group2">2</div>
                    <div class="group-indicator" id="group3">3</div>
                    <div class="group-indicator" id="group4">4</div>
                </div>

                <div class="game-stats hidden" id="gameStats">
                    <button onclick="submitGuess()" id="submitBtn" disabled style="padding: 10px 15px; font-size: 0.85em; margin-right: 12px;">Submit Guess (Select 4 words)</button>
                    <button onclick="clearSelection()" id="clearBtn" style="padding: 10px 15px; font-size: 0.85em;">Clear Selection</button>
                </div>
            </div>

            <div class="suggestions-panel">
                <div id="suggestionsList">
                    <div class="suggestions-title">Suggestions</div>
                    <div class="loading">Load a game to see suggestions!</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div class="info-modal" id="infoModal">
        <div class="info-modal-content">
            <button class="close-button">&times;</button>
            
            <h2>Welcome to ConnectionsAI!</h2>
            <p> Hey! I am Yiming, and I made this bot over the summer of 2024 to solve the popular NYT game Connections. This is a web demonstration of this project, so feel free to play around!</p>

            <h3>How to use?</h3>
            <p> To use ConnectionsAI, load a game either through number or through random. These real Connections games will then be analyzed by the AI, and its suggestions shown on the side. Click on the suggestion to select it. You can choose amongst the AI's top choices, or make your own!</p>
            <h3>How does it work??</h3>
            <p> ConnectionsAI is a bot that uses a process of semantic reasoning, logic, and trial-and-error to solve Connections. It uses a concept called Word Vectors, where the context of words is compared with other words and given values. Those values can then be compared to one another to determine how similar the contexts, and thus the words, are.</p>
            
            <p> For example, the words "monarch" and "ruler" would often be seen with similar surrounding words, such as "king," "crown," "throne," etc. Thus, the AI can determine that they must be pretty similar. Words like "grass" and "bird" may have some similar contexts, like "nature" and "environment," but would also have many different contexts. Thus, the AI can tell that they are kind of similar, but not as similar as "king" and "crown."</p>
            
            <p> Using this, the AI then ranks several groups of words, using how similar the words are to the other words in the group (density) and how dissimilar they are to outsiders (conductance). With weights applied to each of these values, calculated with a genetic algorithm, we get an AI that can play Connections pretty well!</p>
            
            <h3>What are the limitations?</h3>
            <p> Since the words are grouped on semantics, Connections categories that involve proper nouns and how a word is constructed are points of struggle for the bot. There's no way to tell that four words are homonyms just from their contexts. Due to this, it sometimes uses over 40 guesses trying to get a single category, as it uses trial and error to get past its shortcomings.</p>
            
            <h3>I want to know more!</h3>
            <p> I made a video on this bot last summer, so please check it out! Sorry about the bad mic quality, captions are available!</p>
            <p><a href="https://www.youtube.com/watch?v=f_vW9pyRhMs" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=f_vW9pyRhMs</a></p>
        </div>
    </div>

    <script src="game_logic.js"></script>
    <script src="game_data_loader.js"></script>
    <script src="connections_game.js"></script>
    
    <script>
        // Ensure info modal functions are globally available
        function showInfoModal() {
            console.log('showInfoModal called');
            const modal = document.getElementById('infoModal');
            console.log('Modal element:', modal);
            if (modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
                console.log('Modal should now be visible');
            } else {
                console.error('Modal element not found!');
            }
        }

        function hideInfoModal() {
            console.log('hideInfoModal called');
            const modal = document.getElementById('infoModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
                localStorage.setItem('connectionsai-info-seen', 'true');
            }
        }

        function checkFirstVisit() {
            // Always show modal on page load
            setTimeout(() => {
                showInfoModal();
            }, 100);
        }

        // Wait for DOM to load before adding event listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Add click listener to info button
            const infoBtn = document.getElementById('infoBtn');
            if (infoBtn) {
                // Single click event - remove multiple handlers that were causing issues
                infoBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Info button clicked');
                    showInfoModal();
                });
                
                console.log('Info button event listener added');
            } else {
                console.error('Info button not found!');
            }

            // Add click listener to close button
            const closeBtn = document.querySelector('.close-button');
            if (closeBtn) {
                closeBtn.addEventListener('click', hideInfoModal);
            }
        });

        // Close modal when clicking outside of it
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('infoModal');
            const modalContent = modal?.querySelector('.info-modal-content');
            
            if (modal?.classList.contains('show') && modalContent && !modalContent.contains(e.target)) {
                hideInfoModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const modal = document.getElementById('infoModal');
                if (modal?.classList.contains('show')) {
                    hideInfoModal();
                }
            }
        });
    </script>
</body>
</html>