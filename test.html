<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connections AI - Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a2e;
            color: #eee;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background-color: #2d5016;
            border: 1px solid #4caf50;
        }
        .error {
            background-color: #5d1a1a;
            border: 1px solid #f44336;
        }
        .info {
            background-color: #1a365d;
            border: 1px solid #2196f3;
        }
        button {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        pre {
            background-color: #2a2a2a;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Connections AI - GitHub Pages Test</h1>
    <p>This page tests that the static version works correctly without a Python server.</p>
    
    <button onclick="runTests()">Run Tests</button>
    <button onclick="testRandomGame()">Test Random Game</button>
    <button onclick="clearResults()">Clear Results</button>
    
    <div id="results"></div>

    <script src="game_logic.js"></script>
    <script src="game_data_loader.js"></script>
    
    <script>
        async function addResult(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = message;
            results.appendChild(div);
            results.scrollTop = results.scrollHeight;
        }

        async function runTests() {
            await addResult('Starting tests...', 'info');
            
            try {
                // Test 1: Initialize data loader
                await addResult('Testing data loader initialization...', 'info');
                const success = await window.gameDataLoader.initialize();
                if (success) {
                    await addResult('Data loader initialized successfully', 'success');
                    await addResult(`Found ${window.gameDataLoader.getTotalGames()} games available`, 'success');
                } else {
                    await addResult('Failed to initialize data loader', 'error');
                    return;
                }

                // Test 2: Load a specific game
                await addResult('Testing game loading...', 'info');
                const gameData = await window.gameDataLoader.loadGame(0);
                if (gameData && gameData.words && gameData.words.length === 16) {
                    await addResult('Game loaded successfully', 'success');
                    await addResult(`Game 0 words: ${gameData.words.join(', ')}`, 'info');
                } else {
                    await addResult('Failed to load game data correctly', 'error');
                    return;
                }

                // Test 3: Test game logic
                await addResult('Testing game logic...', 'info');
                const gameLogic = new GameLogic();
                if (gameLogic && gameLogic.calcDensity && gameLogic.calcConductance) {
                    await addResult('Game logic initialized successfully', 'success');
                } else {
                    await addResult('Game logic failed to initialize', 'error');
                    return;
                }

                // Test 4: Test adjacency matrix
                await addResult('Testing adjacency matrix...', 'info');
                if (gameData.adjacency_matrix && gameData.adjacency_matrix.length === 16) {
                    const testDensity = gameLogic.calcDensity([0, 1, 2, 3], gameData.adjacency_matrix);
                    if (typeof testDensity === 'number') {
                        await addResult(`Adjacency matrix test passed. Density: ${testDensity.toFixed(4)}`, 'success');
                    } else {
                        await addResult('Adjacency matrix calculation failed', 'error');
                    }
                } else {
                    await addResult('Invalid adjacency matrix structure', 'error');
                }

                // Test 5: Test random game
                await addResult('Testing random game selection...', 'info');
                const randomGameNum = window.gameDataLoader.getRandomGameNumber();
                const randomGame = await window.gameDataLoader.loadGame(randomGameNum);
                if (randomGame && randomGame.words) {
                    await addResult(`Random game ${randomGameNum} loaded: ${randomGame.words.slice(0, 4).join(', ')}...`, 'success');
                } else {
                    await addResult('Random game loading failed', 'error');
                }

                await addResult('All tests completed successfully', 'success');

            } catch (error) {
                await addResult(`Test failed with error: ${error.message}`, 'error');
                console.error('Test error:', error);
            }
        }

        async function testRandomGame() {
            try {
                await addResult('Loading random game...', 'info');
                const randomGameNum = window.gameDataLoader.getRandomGameNumber();
                const gameData = await window.gameDataLoader.loadGame(randomGameNum);
                
                await addResult(`Game ${randomGameNum} loaded successfully`, 'success');
                await addResult(`<pre>Words: ${JSON.stringify(gameData.words, null, 2)}</pre>`, 'info');
                
            } catch (error) {
                await addResult(`Random game test failed: ${error.message}`, 'error');
            }
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        // Auto-run tests when page loads
        window.addEventListener('load', () => {
            setTimeout(runTests, 100);
        });
    </script>
</body>
</html>